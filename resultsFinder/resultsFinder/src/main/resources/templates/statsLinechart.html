<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Resizable & Draggable Chart (Top-Left Anchored)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-container {
            width: 50%;
            max-width: 600px;
            height: 300px;
            position: absolute;
            top: 100px;
            left: 100px;
            cursor: grab;
            background: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
            padding: 10px;
            resize: none; /* Disable browser's default resizing */
            overflow: hidden; /* Prevent overflow */
        }
        .resize-handle {
            width: 15px;
            height: 15px;
            background: gray;
            position: absolute;
            bottom: 0;
            right: 0;
            cursor: se-resize;
            border-radius: 50%;
        }
    </style>
</head>
<body>

    <div id="draggable-chart" class="chart-container">
        <canvas id="myLineChart"></canvas>
        <div class="resize-handle"></div> <!-- Resize handle -->
    </div>

    <script th:inline="javascript">
        var wins = /*[[${wins}]]*/ [];
        var losses = /*[[${losses}]]*/ [];
		var draws = /*[[${draws}]]*/ [];
		var matches = /*[[${matches}]]*/ [];

		var ctx = document.getElementById('myLineChart').getContext('2d');
		    var myLineChart = new Chart(ctx, {
		        type: 'line',
		        data: {
		            labels: matches,  // X-axis (Time)
		            datasets: [
		                {
		                    label: 'Wins',
		                    data: wins,
		                    borderColor: 'blue',
		                    backgroundColor: 'rgba(0, 0, 255, 0.2)',
		                    fill: false
		                },
		                {
		                    label: 'Losses',
		                    data: losses,
		                    borderColor: 'red',
		                    backgroundColor: 'rgba(255, 0, 0, 0.2)',
		                    fill: false
		                },
		                {
		                    label: 'Draws',
		                    data: draws,
		                    borderColor: 'green',
		                    backgroundColor: 'rgba(0, 255, 0, 0.2)',
		                    fill: false
		                }
		            ]
		        },
		        options: {
		            responsive: true,
		            maintainAspectRatio: false,
		            scales: {
		                x: { title: { display: true, text: '#Matches' } },
		                y: { title: { display: true, text: 'W/L/D' } }
		            }
		        }
        });

        // Draggable Functionality
        let chartContainer = document.getElementById("draggable-chart");
        let isDragging = false, offsetX, offsetY;

        chartContainer.addEventListener("mousedown", function(e) {
            if (e.target.classList.contains("resize-handle")) return; // Prevent dragging when resizing
            isDragging = true;
            offsetX = e.clientX - chartContainer.offsetLeft;
            offsetY = e.clientY - chartContainer.offsetTop;
            chartContainer.style.cursor = "grabbing";
        });

        document.addEventListener("mousemove", function(e) {
            if (isDragging) {
                chartContainer.style.left = (e.clientX - offsetX) + "px";
                chartContainer.style.top = (e.clientY - offsetY) + "px";
            }
        });

        document.addEventListener("mouseup", function() {
            isDragging = false;
            chartContainer.style.cursor = "grab";
        });

        // Resizable Functionality (Anchored to Top-Left)
        let resizeHandle = document.querySelector(".resize-handle");
        let isResizing = false, startX, startY, startWidth, startHeight;

        resizeHandle.addEventListener("mousedown", function(e) {
            isResizing = true;
            startX = e.clientX;
            startY = e.clientY;
            startWidth = chartContainer.offsetWidth;
            startHeight = chartContainer.offsetHeight;
            e.preventDefault();
        });

        document.addEventListener("mousemove", function(e) {
            if (isResizing) {
                let newWidth = Math.max(200, startWidth + (e.clientX - startX)); // Minimum width = 200px
                let newHeight = Math.max(150, startHeight + (e.clientY - startY)); // Minimum height = 150px
                chartContainer.style.width = newWidth + "px";
                chartContainer.style.height = newHeight + "px";

                // Ensure the chart resizes properly
                myLineChart.canvas.width = newWidth - 20;
                myLineChart.canvas.height = newHeight - 20;
                myLineChart.resize();
            }
        });

        document.addEventListener("mouseup", function() {
            isResizing = false;
        });

    </script>

</body>
</html>